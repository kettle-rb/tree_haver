<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  File: POSITION-API-SUMMARY
  
    &mdash; Documentation by YARD 0.9.38
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" />

  <link rel="stylesheet" href="css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "POSITION-API-SUMMARY";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="file_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index</a> &raquo; 
    <span class="title">File: POSITION-API-SUMMARY</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><div id='filecontents'><h1 id="position-api">Position API</h1>

<p><strong>Date:</strong> December 18, 2025<br>
<strong>Feature:</strong> Unified Position API for all tree_haver backends<br>
<strong>Version:</strong> Unreleased (planned for v3.1.0)</p>

<hr>

<h2 id="what-was-done">What Was Done</h2>

<p>Added four position-related methods to all tree_haver backend Node classes to provide a consistent API for position information across all backends:</p>

<h3 id="new-methods">New Methods</h3>

<ol>
  <li>
<strong><code>start_line</code></strong> - Returns 1-based line number where node starts
    <ul>
      <li>Converts 0-based row to 1-based line number</li>
      <li>Formula: <code>start_point.row + 1</code> (or uses backend’s native 1-based line if available)</li>
    </ul>
  </li>
  <li>
<strong><code>end_line</code></strong> - Returns 1-based line number where node ends
    <ul>
      <li>Converts 0-based row to 1-based line number</li>
      <li>Formula: <code>end_point.row + 1</code> (or uses backend’s native 1-based line if available)</li>
    </ul>
  </li>
  <li>
<strong><code>source_position</code></strong> - Returns position hash with 1-based lines and 0-based columns
    <ul>
      <li>Format: <code>{start_line:, end_line:, start_column:, end_column:}</code>
</li>
      <li>Compatible with <code>*-merge</code> gems’ <code>FileAnalysisBase</code> expectations</li>
      <li>Lines are 1-based (human-readable)</li>
      <li>Columns are 0-based (matches tree-sitter convention)</li>
    </ul>
  </li>
  <li>
<strong><code>first_child</code></strong> - Convenience method for iteration
    <ul>
      <li>Returns <code>children.first</code>
</li>
      <li>Provides compatibility with code expecting <code>first_child</code> method</li>
    </ul>
  </li>
</ol>

<hr>

<h2 id="backends-updated">Backends Updated</h2>

<h3 id="-main-treehavernode-wrapper">✅ Main TreeHaver::Node Wrapper</h3>
<p><strong>File:</strong> <code>vendor/tree_haver/lib/tree_haver/node.rb</code><br>
<strong>Lines:</strong> 113-149, 230-241</p>

<p>Added all four methods to the main unified Node wrapper. This automatically covers:</p>
<ul>
  <li>Tree-sitter MRI backend</li>
  <li>Tree-sitter FFI backend</li>
  <li>Tree-sitter Java backend</li>
  <li>Tree-sitter Rust backend</li>
</ul>

<p>All tree-sitter backends use <code>TreeHaver::Node</code> to wrap their raw nodes, so they inherit these methods automatically.</p>

<h3 id="-commonmarker-backend-already-complete">✅ Commonmarker Backend (Already Complete)</h3>
<p><strong>File:</strong> <code>vendor/tree_haver/lib/tree_haver/backends/commonmarker.rb</code><br>
<strong>Lines:</strong> 286-324