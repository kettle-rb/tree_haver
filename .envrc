# Run any command in this library's bin/ without the bin/ prefix!

# Prefer exe version over binstub

PATH_add exe
PATH_add bin

# Only add things to this file that should be shared with the team.

# **dotenv** (See end of file for .env.local integration)

# .env would override anything in this file, if enabled.

# .env is a DOCKER standard, and if we use it, it would be in deployed, or DOCKER, environments.

# Override and customize anything below in your own .env.local

# If you are using dotenv and not direnv,

#   copy the following `export` statements to your own .env file.

### General Ruby ###

# Turn off Ruby Warnings about deprecated code

# export RUBYOPT="-W0"

### External Testing Controls

export K_SOUP_COV_DO=true # Means you want code coverage
export K_SOUP_COV_COMMAND_NAME="Test Coverage"

# Enable coverage merging across multiple test runs (ffi_specs, backend_matrix_specs, remaining_specs)
export K_SOUP_COV_USE_MERGING=true
export K_SOUP_COV_MERGE_TIMEOUT=3600 # 1 hour - enough time for all test runs to complete

# Available formats are html, xml, rcov, lcov, json, tty

export K_SOUP_COV_FORMATTERS="html,xml,rcov,lcov,json,tty"
export K_SOUP_COV_MIN_BRANCH=81 # Means you want to enforce X% branch coverage
export K_SOUP_COV_MIN_LINE=93 # Means you want to enforce X% line coverage
export K_SOUP_COV_MIN_HARD=false # Means you want the build to fail if the coverage thresholds are not met
export K_SOUP_COV_MULTI_FORMATTERS=false
export K_SOUP_COV_OPEN_BIN=false # Means don't try to open coverage results in browser
export MAX_ROWS=1 # Setting for simplecov-console gem for tty output, limits to the worst N rows of bad coverage
export KETTLE_TEST_SILENT=true
export KETTLE_DEV_DEBUG=false
export KETTLE_RB_DEV=false

# Internal Debugging Controls

export DEBUG=false # do not allow byebug statements (override in .env.local)
export FLOSS_CFG_FUND_DEBUG=false # extra logging to help diagnose issues (override in .env.local)
export FLOSS_CFG_FUND_LOGFILE=tmp/log/debug.log

# YARD - the yard-fence plugin is able to clean up the docs dir on each run, so stale docs don't linger
export YARD_FENCE_CLEAN_DOCS=true

# Concurrently developing the rubocop-lts suite?
export RUBOCOP_LTS_LOCAL=false

# If tree_haver does not have an open source collective set these to false.

export OPENCOLLECTIVE_HANDLE=kettle-rb
export FUNDING_ORG=kettle-rb

# tree_haver dependencies (SONAME form)
export TREE_SITTER_RUNTIME_LIB=/home/linuxbrew/.linuxbrew/Cellar/tree-sitter/0.26.3/lib/libtree-sitter.so
# Run vendor/setup-java-tree-sitter.sh to download JARs
export TREE_SITTER_JAVA_JARS_DIR=/home/pboling/src/kettle-rb/ast-merge/vendor/tree_haver/vendor/jars
# JVM options for java-tree-sitter:
# - --enable-native-access: Required for Java Foreign Function API
# - -Djava.library.path: Path to libtree-sitter.so for JNI loading
export JAVA_OPTS="--enable-native-access=ALL-UNNAMED -Djava.library.path=/home/linuxbrew/.linuxbrew/Cellar/tree-sitter/0.26.3/lib"
export JRUBY_OPTS="-J--enable-native-access=ALL-UNNAMED -J-Djava.library.path=/home/linuxbrew/.linuxbrew/Cellar/tree-sitter/0.26.3/lib"
export CLASSPATH="${TREE_SITTER_JAVA_JARS_DIR}/jtreesitter-0.26.0.jar${CLASSPATH:+:$CLASSPATH}"
# If Ruby/JRuby cannot find libraries at runtime, you may need to export:
# LD_LIBRARY_PATH is needed for java-tree-sitter to find libtree-sitter.so at runtime
# export LD_LIBRARY_PATH=/usr/local/lib:/usr/lib64:/usr/lib
export LD_LIBRARY_PATH="/home/linuxbrew/.linuxbrew/Cellar/tree-sitter/0.26.3/lib${LD_LIBRARY_PATH:+:$LD_LIBRARY_PATH}"

# Example language library path:
# Luarocks grammars were built with treesitter < 0.24, which has a different ABI than later versions.
# export TREE_SITTER_TOML_PATH=/home/pboling/.local/share/mise/installs/lua/5.4.8/luarocks/lib/luarocks/rocks-5.4/tree-sitter-toml/0.0.31-1/parser/toml.so
# export TREE_SITTER_JSON_PATH=/home/pboling/.local/share/mise/installs/lua/5.4.8/luarocks/lib/luarocks/rocks-5.4/tree-sitter-json/0.0.29-1/parser/json.so
# export TREE_SITTER_JSONC_PATH=/home/pboling/.local/share/mise/installs/lua/5.4.8/luarocks/lib/luarocks/rocks-5.4/tree-sitter-jsonc/0.0.29-1/parser/jsonc.so
# Luarocks version (incompatible with MRI backend):
# export TREE_SITTER_BASH_PATH=/home/pboling/.local/share/mise/installs/lua/5.4.8/luarocks/lib/luarocks/rocks-5.4/tree-sitter-bash/0.0.49-1/parser/bash.so
# npm version (N-API, so WILL NOT WORK with ruby_tree_sitter):
# export TREE_SITTER_BASH_PATH=/var/home/pboling/.local/share/mise/installs/node/23.11.0/lib/node_modules/tree-sitter-bash/prebuilds/linux-x64/tree-sitter-bash.node
# Compiled from source (compatible with ruby_tree_sitter, by tree_haver's `bin/build-grammar <grammar-name>`)
export TREE_SITTER_BASH_PATH="/home/pboling/.local/lib/tree-sitter/libtree-sitter-bash.so"
export TREE_SITTER_CSS_PATH="/home/pboling/.local/lib/tree-sitter/libtree-sitter-css.so"
export TREE_SITTER_JAVASCRIPT_PATH="/home/pboling/.local/lib/tree-sitter/libtree-sitter-javascript.so"
export TREE_SITTER_JSON_PATH="/home/pboling/.local/lib/tree-sitter/libtree-sitter-json.so"
export TREE_SITTER_JSONC_PATH="/home/pboling/.local/lib/tree-sitter/libtree-sitter-jsonc.so"
export TREE_SITTER_PYTHON_PATH="/home/pboling/.local/lib/tree-sitter/libtree-sitter-python.so"
export TREE_SITTER_RBS_PATH="/home/pboling/.local/lib/tree-sitter/libtree-sitter-rbs.so"
export TREE_SITTER_RUBY_PATH="/home/pboling/.local/lib/tree-sitter/libtree-sitter-ruby.so"
export TREE_SITTER_TOML_PATH="/home/pboling/.local/lib/tree-sitter/libtree-sitter-toml.so"
export TREE_SITTER_YAML_PATH="/home/pboling/.local/lib/tree-sitter/libtree-sitter-yaml.so"

# .env would override anything in this file, if `dotenv` is uncommented below.

# .env is a DOCKER standard, and if we use it, it would be in deployed, or DOCKER, environments,

#   and that is why we generally want to leave it commented out.

# dotenv

# .env.local will override anything in this file.

dotenv_if_exists .env.local
